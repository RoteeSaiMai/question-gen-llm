

import ollama

def generate_question_prompt(previous_questions, text):
    """
    Generates a prompt for asking a well-structured question, considering previously asked questions.
    """
    prompt = f'ข้อความ: {text}\n\n'
    prompt += '''กรุณาสร้างคำถามที่มีคำตอบชัดเจนหนึ่งข้อเป็นภาษาไทย โดยอิงจากข้อมูลและรายละเอียดในข้อความข้างต้นเท่านั้น ห้ามถามเกี่ยวกับตัวข้อความเอง แต่ให้ใช้ข้อมูลในข้อความในการสร้างคำถาม. คำถามควรมีคำตอบที่ชัดเจน ไม่กำกวม และไม่เปิดกว้างต่อการตีความ พยายามใช้หลักของ Bloom's Taxonomy เพื่อกำหนดโครงสร้างของคำถาม:

    Bloom's Taxonomy:
    1. Remembering: การเรียกคืนข้อมูลและแนวคิดพื้นฐาน (เช่น กำหนด, ระบุ, แยกแยะ).
    2. Understanding: การอธิบายแนวคิดหรือแนวคิด (เช่น อธิบาย, สรุป, อธิบาย).
    3. Applying: การใช้ข้อมูลในสถานการณ์ใหม่ (เช่น ใช้, ดำเนินการ, แก้ไขปัญหา).
    4. Analyzing: การวิเคราะห์และเชื่อมโยงแนวคิด (เช่น เปรียบเทียบ, วิเคราะห์, ตรวจสอบ).
    5. Evaluating: การประเมินผลการตัดสินใจหรือการกระทำ (เช่น ประเมิน, วิจารณ์, แนะนำ).
    6. Creating: การสร้างผลงานใหม่หรือดั้งเดิม (เช่น ออกแบบ, ประกอบ, สร้าง).

    ตรวจสอบให้แน่ใจว่าคำถามเป็นภาษาไทยที่เป็นธรรมชาติและใช้ภาษาไทยตามบริบท. คำถามควรมีคำตอบที่ชัดเจนและไม่ควรถามในลักษณะที่เปิดกว้างหรือคลุมเครือ:
    '''
    
    if previous_questions:
        prompt += "ด้านล่างเป็นรายการคำถามที่เคยถามไปแล้ว:\n\n"
        for idx, question in enumerate(previous_questions, 1):
            prompt += f"{idx}. {question}\n"

    return prompt

def evaluate_response_prompt(question, user_response, previous_evaluations, text):
    """
    Generates a prompt for evaluating the user's response to a well-structured question.
    The evaluation should follow good principles for assessment, providing clear reasoning and constructive feedback.
    """
    prompt = f'ข้อความ: {text}\n\n'
    prompt += f"คำถามเกี่ยวกับข้อความที่ถูกถามไป: {question}\n\n"
    prompt += f"คำตอบของผู้ใช้:\n{user_response}\n\n"
    prompt += '''จากคำตอบนี้ กรุณาประเมินคำตอบและให้ข้อเสนอแนะโดยใช้หลักการที่ดีในการประเมินคำตอบ โปรดระบุว่าคำตอบนั้นถูกต้องหรือไม่ หากไม่ถูกต้อง โปรดให้คำตอบที่ถูกต้องพร้อมเหตุผลที่ชัดเจนและเฉพาะเจาะจงสำหรับการประเมินนั้น คำตอบควรอยู่ในขอบเขตไม่เกิน 5 ประโยค และใช้ภาษาไทยที่เข้าใจง่ายเท่านั้น.

    สำหรับการประเมินคำตอบ:
    1. ความถูกต้องของเนื้อหา: ตรวจสอบว่าคำตอบสอดคล้องกับข้อมูลและแนวคิดที่ถูกต้องตามที่ปรากฏในข้อความต้นฉบับหรือไม่.
    2. การใช้เหตุผลและตรรกะ: ประเมินว่าคำตอบมีการใช้เหตุผลที่เหมาะสมและสอดคล้องกับข้อเท็จจริงหรือไม่.
    3. ความชัดเจนและกระชับ: ตรวจสอบว่าคำตอบมีความชัดเจนในคำอธิบายและไม่เยิ่นเย้อหรือซับซ้อนเกินไป.
    4. การเชื่อมโยงกับ Bloom's Taxonomy: พิจารณาว่าคำตอบสอดคล้องกับระดับความรู้ที่เกี่ยวข้องใน Bloom's Taxonomy อย่างไร (เช่น การจำ, การทำความเข้าใจ, การประยุกต์ใช้, การวิเคราะห์, การประเมินผล, หรือการสร้างสรรค์).
    5. ข้อเสนอแนะเพื่อการพัฒนา: หากคำตอบไม่ถูกต้องหรือไม่สมบูรณ์ โปรดให้ข้อเสนอแนะที่เป็นประโยชน์และสร้างสรรค์เพื่อให้ผู้ตอบสามารถพัฒนาคำตอบในอนาคตได้.

    โปรดใช้รูปแบบการเริ่มต้นการประเมินดังนี้:
    - หากคำตอบถูกต้อง ให้เริ่มคำตอบด้วย [CORRECT] และตามด้วยคำอธิบายว่าเหตุใดคำตอบจึงถูกต้อง.
    - หากคำตอบไม่ถูกต้อง ให้เริ่มคำตอบด้วย [WRONG] และอธิบายข้อผิดพลาดและให้คำตอบที่ถูกต้องพร้อมเหตุผล.

    ให้คำตอบเป็นภาษาไทยเท่านั้น
    '''
    return prompt
